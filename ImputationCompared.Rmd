---
title: "R Notebook"
output: html_notebook
---

using cgm data and applying the following imputation methods
= {forecast} -> na.interp 
= {zoo} -> na.approx ; na.spline
introducing gaps of 5, 10, 15, 20,...,50 and repeating the imputations 100 times
calculating error rate average for each




loading packages
```{r}
require(forecast)
require(zoo)
require(DTWBI)
require(openair)
require(stats)
```



importing data
```{r}
series = read.csv('~/Desktop/NCSA_genomics/CGManalyzer-datasets/ID01.csv')
series$glucoseValue[series$glucoseValue==0.0] <- NA

series = na.omit(series)

plot(series$glucoseValue, type='l', ylab='Glucose Level')

```

sampling seed points
```{r}
seed_points <- sample(1:2400, 100, replace = FALSE)
#seed_points
```


na.interp error lists for plotting
```{r}
mad_interp = c()
frac_bias_interp = c()
rmse_interp = c()
ioa_interp = c()
```


Method = {forecast}na.interp 
Gap = 5
```{r}
mad_interp_5 = c()
fractional_bias_interp_5 = c()
rmse_interp_5 = c()
ioa_interp_5 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:4) { #runs 5 times for every i loop iteration to introduce a gap of 5 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 5 starting from the seed point, so now we interpolate and get the error for the iteration
  series_new$glucoseValue = na.interp(series_new$glucoseValue)
  
  #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_interp_5 = c(mad_interp_5,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_interp_5 = c(fractional_bias_interp_5, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_interp_5 = c(rmse_interp_5,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed",obs = "real", statistic = c("IOA"))
  ioa_interp_5 = c(ioa_interp_5, temp4$IOA)
  
  
}


mean_fractional_bias_interp_5 = mean(fractional_bias_interp_5)
cat("Mean Fractional Bias for na.interp method with Gap Value of 5 is ",mean_fractional_bias_interp_5, "thats is, ",mean_fractional_bias_interp_5*100,"%\n\n")

mean_rmse_interp_5 = mean(rmse_interp_5)
cat("Mean RMSE for na.interp method with Gap Value of 5 is ",mean_rmse_interp_5, "thats is, ",mean_rmse_interp_5*100,"%\n\n")

mean_ioa_interp_5 = mean(ioa_interp_5)
cat("Mean IOA for na.interp method with Gap Value of 5 is ",mean_ioa_interp_5, "thats is, ",mean_ioa_interp_5*100,"%\n\n")

mean_mad_interp_5 = mean(mad_interp_5)
cat("Mean MAD for na.interp method with Gap Value of 5 is ",mean_mad_interp_5,"\n\n")

mad_interp = c(mad_interp,mean_mad_interp_5)
frac_bias_interp = c(frac_bias_interp,mean_fractional_bias_interp_5)
rmse_interp = c(rmse_interp,mean_rmse_interp_5)
ioa_interp = c(ioa_interp, mean_ioa_interp_5)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_interp_5)
rm(mean_mad_interp_5)
rm(fractional_bias_interp_5)
rm(mean_fractional_bias_interp_5)
rm(rmse_interp_5)
rm(mean_rmse_interp_5)
rm(ioa_interp_5)
rm(mean_ioa_interp_5)


```


Method = {forecast}na.interp 
Gap = 10
```{r}
mad_interp_10 = c()
fractional_bias_interp_10 = c()
rmse_interp_10 = c()
ioa_interp_10 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:9) { #runs 10 times for every i loop iteration to introduce a gap of 10 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 10 starting from the seed point, so now we interpolate and get the error for the iteration
  series_new$glucoseValue = na.interp(series_new$glucoseValue)
 
   #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_interp_10 = c(mad_interp_10,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_interp_10 = c(fractional_bias_interp_10, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_interp_10 = c(rmse_interp_10,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed",obs = "real", statistic = c("IOA"))
  ioa_interp_10 = c(ioa_interp_10, temp4$IOA)
  
}



mean_fractional_bias_interp_10 = mean(fractional_bias_interp_10)
cat("Mean Fractional Bias for na.interp method with Gap Value of 10 is ",mean_fractional_bias_interp_10, "thats is, ",mean_fractional_bias_interp_10*100,"%\n\n")

mean_rmse_interp_10 = mean(rmse_interp_10)
cat("Mean RMSE for na.interp method with Gap Value of 10 is ",mean_rmse_interp_10, "thats is, ",mean_rmse_interp_10*100,"%\n\n")

mean_ioa_interp_10 = mean(ioa_interp_10)
cat("Mean IOA for na.interp method with Gap Value of 10 is ",mean_ioa_interp_10, "thats is, ",mean_ioa_interp_10*100,"%\n\n")

mean_mad_interp_10 = mean(mad_interp_10)
cat("Mean MAD for na.interp method with Gap Value of 10 is ",mean_mad_interp_10,"\n\n")

mad_interp = c(mad_interp,mean_mad_interp_10)
frac_bias_interp = c(frac_bias_interp,mean_fractional_bias_interp_10)
rmse_interp = c(rmse_interp,mean_rmse_interp_10)
ioa_interp = c(ioa_interp, mean_ioa_interp_10)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_interp_10)
rm(mean_mad_interp_10)
rm(fractional_bias_interp_10)
rm(mean_fractional_bias_interp_10)
rm(rmse_interp_10)
rm(mean_rmse_interp_10)
rm(ioa_interp_10)
rm(mean_ioa_interp_10)


```


Method = {forecast}na.interp 
Gap = 20
```{r}
mad_interp_20 = c()
fractional_bias_interp_20 = c()
rmse_interp_20 = c()
ioa_interp_20 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:19) { #runs 20 times for every i loop iteration to introduce a gap of 20 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 20 starting from the seed point, so now we interpolate and get the error for the iteration
  series_new$glucoseValue = na.interp(series_new$glucoseValue)
  
  #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_interp_20 = c(mad_interp_20,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_interp_20 = c(fractional_bias_interp_20, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_interp_20 = c(rmse_interp_20,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed",obs = "real", statistic = c("IOA"))
  ioa_interp_20 = c(ioa_interp_20, temp4$IOA)
  
}


mean_fractional_bias_interp_20 = mean(fractional_bias_interp_20)
cat("Mean Fractional Bias for na.interp method with Gap Value of 20 is ",mean_fractional_bias_interp_20, "thats is, ",mean_fractional_bias_interp_20*100,"%\n\n")

mean_rmse_interp_20 = mean(rmse_interp_20)
cat("Mean RMSE for na.interp method with Gap Value of 20 is ",mean_rmse_interp_20, "thats is, ",mean_rmse_interp_20*100,"%\n\n")

mean_ioa_interp_20 = mean(ioa_interp_20)
cat("Mean IOA for na.interp method with Gap Value of 20 is ",mean_ioa_interp_20, "thats is, ",mean_ioa_interp_20*100,"%\n\n")

mean_mad_interp_20 = mean(mad_interp_20)
cat("Mean MAD for na.interp method with Gap Value of 20 is ",mean_mad_interp_20,"\n\n")

mad_interp = c(mad_interp,mean_mad_interp_20)
frac_bias_interp = c(frac_bias_interp,mean_fractional_bias_interp_20)
rmse_interp = c(rmse_interp,mean_rmse_interp_20)
ioa_interp = c(ioa_interp, mean_ioa_interp_20)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_interp_20)
rm(mean_mad_interp_20)
rm(fractional_bias_interp_20)
rm(mean_fractional_bias_interp_20)
rm(rmse_interp_20)
rm(mean_rmse_interp_20)
rm(ioa_interp_20)
rm(mean_ioa_interp_20)

```


Method = {forecast}na.interp 
Gap = 25
```{r}
mad_interp_25 = c()
fractional_bias_interp_25 = c()
rmse_interp_25 = c()
ioa_interp_25 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:24) { #runs 25 times for every i loop iteration to introduce a gap of 25 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 25 starting from the seed point, so now we interpolate and get the error for the iteration
  series_new$glucoseValue = na.interp(series_new$glucoseValue)
  
  #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_interp_25 = c(mad_interp_25,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_interp_25 = c(fractional_bias_interp_25, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_interp_25 = c(rmse_interp_25,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed",obs = "real", statistic = c("IOA"))
  ioa_interp_25 = c(ioa_interp_25, temp4$IOA)
  
  
}


mean_fractional_bias_interp_25 = mean(fractional_bias_interp_25)
cat("Mean Fractional Bias for na.interp method with Gap Value of 25 is ",mean_fractional_bias_interp_25, "thats is, ",mean_fractional_bias_interp_25*100,"%\n\n")

mean_rmse_interp_25 = mean(rmse_interp_25)
cat("Mean RMSE for na.interp method with Gap Value of 25 is ",mean_rmse_interp_25, "thats is, ",mean_rmse_interp_25*100,"%\n\n")

mean_ioa_interp_25 = mean(ioa_interp_25)
cat("Mean IOA for na.interp method with Gap Value of 25 is ",mean_ioa_interp_25, "thats is, ",mean_ioa_interp_25*100,"%\n\n")

mean_mad_interp_25 = mean(mad_interp_25)
cat("Mean MAD for na.interp method with Gap Value of 25 is ",mean_mad_interp_25,"\n\n")

mad_interp = c(mad_interp,mean_mad_interp_25)
frac_bias_interp = c(frac_bias_interp,mean_fractional_bias_interp_25)
rmse_interp = c(rmse_interp,mean_rmse_interp_25)
ioa_interp = c(ioa_interp, mean_ioa_interp_25)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_interp_25)
rm(mean_mad_interp_25)
rm(fractional_bias_interp_25)
rm(mean_fractional_bias_interp_25)
rm(rmse_interp_25)
rm(mean_rmse_interp_25)
rm(ioa_interp_25)
rm(mean_ioa_interp_25)

```


Method = {forecast}na.interp 
Gap = 50
```{r}
mad_interp_50 = c()
fractional_bias_interp_50 = c()
rmse_interp_50 = c()
ioa_interp_50 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:49) { #runs 50 times for every i loop iteration to introduce a gap of 50 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 50 starting from the seed point, so now we interpolate and get the error for the iteration
  series_new$glucoseValue = na.interp(series_new$glucoseValue)
  
  #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_interp_50 = c(mad_interp_50,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_interp_50 = c(fractional_bias_interp_50, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_interp_50 = c(rmse_interp_50,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed",obs = "real", statistic = c("IOA"))
  ioa_interp_50 = c(ioa_interp_50, temp4$IOA)
  
}



mean_fractional_bias_interp_50 = mean(fractional_bias_interp_50)
cat("Mean Fractional Bias for na.interp method with Gap Value of 50 is ",mean_fractional_bias_interp_50, "thats is, ",mean_fractional_bias_interp_50*100,"%\n\n")

mean_rmse_interp_50 = mean(rmse_interp_50)
cat("Mean RMSE for na.interp method with Gap Value of 50 is ",mean_rmse_interp_50, "thats is, ",mean_rmse_interp_50*100,"%\n\n")

mean_ioa_interp_50 = mean(ioa_interp_50)
cat("Mean IOA for na.interp method with Gap Value of 50 is ",mean_ioa_interp_50, "thats is, ",mean_ioa_interp_50*100,"%\n\n")

mean_mad_interp_50 = mean(mad_interp_50)
cat("Mean MAD for na.interp method with Gap Value of 50 is ",mean_mad_interp_50,"\n\n")

mad_interp = c(mad_interp,mean_mad_interp_50)
frac_bias_interp = c(frac_bias_interp,mean_fractional_bias_interp_50)
rmse_interp = c(rmse_interp,mean_rmse_interp_50)
ioa_interp = c(ioa_interp, mean_ioa_interp_50)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_interp_50)
rm(mean_mad_interp_50)
rm(fractional_bias_interp_50)
rm(mean_fractional_bias_interp_50)
rm(rmse_interp_50)
rm(mean_rmse_interp_50)
rm(ioa_interp_50)
rm(mean_ioa_interp_50)

```
Method = {forecast}na.interp 
Gap = 100
```{r}
mad_interp_100 = c()
fractional_bias_interp_100 = c()
rmse_interp_100 = c()
ioa_interp_100 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:99) { #runs 100 times for every i loop iteration to introduce a gap of 100 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 50 starting from the seed point, so now we interpolate and get the error for the iteration
  series_new$glucoseValue = na.interp(series_new$glucoseValue)
  
  #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_interp_100 = c(mad_interp_100,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_interp_100 = c(fractional_bias_interp_100, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_interp_100 = c(rmse_interp_100,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed",obs = "real", statistic = c("IOA"))
  ioa_interp_100 = c(ioa_interp_100, temp4$IOA)
  
}



mean_fractional_bias_interp_100 = mean(fractional_bias_interp_100)
cat("Mean Fractional Bias for na.interp method with Gap Value of 100 is ",mean_fractional_bias_interp_100, "thats is, ",mean_fractional_bias_interp_100*100,"%\n\n")

mean_rmse_interp_100 = mean(rmse_interp_100)
cat("Mean RMSE for na.interp method with Gap Value of 100 is ",mean_rmse_interp_100, "thats is, ",mean_rmse_interp_100*100,"%\n\n")

mean_ioa_interp_100 = mean(ioa_interp_100)
cat("Mean IOA for na.interp method with Gap Value of 100 is ",mean_ioa_interp_100, "thats is, ",mean_ioa_interp_100*100,"%\n\n")

mean_mad_interp_100 = mean(mad_interp_100)
cat("Mean MAD for na.interp method with Gap Value of 100 is ",mean_mad_interp_100,"\n\n")

mad_interp = c(mad_interp,mean_mad_interp_100)
frac_bias_interp = c(frac_bias_interp,mean_fractional_bias_interp_100)
rmse_interp = c(rmse_interp,mean_rmse_interp_100)
ioa_interp = c(ioa_interp, mean_ioa_interp_100)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_interp_100)
rm(mean_mad_interp_100)
rm(fractional_bias_interp_100)
rm(mean_fractional_bias_interp_100)
rm(rmse_interp_100)
rm(mean_rmse_interp_100)
rm(ioa_interp_100)
rm(mean_ioa_interp_100)

```


na.interp final values
```{r}
mad_interp
frac_bias_interp
rmse_interp
ioa_interp
```

na.approx error lists for plotting
```{r}
mad_approx = c()
frac_bias_approx = c()
rmse_approx = c()
ioa_approx = c()
```


Method = {zoo}na.approx
Gap = 5
```{r}
mad_approx_5 = c()
fractional_bias_approx_5 = c()
rmse_approx_5 = c()
ioa_approx_5 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:4) { #runs 5 times for every i loop iteration to introduce a gap of 5 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 5 starting from the seed point, so now we approximate and get the error for the iteration
  series_new$glucoseValue = na.approx(series_new$glucoseValue)
  
  #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_approx_5 = c(mad_approx_5,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_approx_5 = c(fractional_bias_approx_5, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_approx_5 = c(rmse_approx_5,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed",obs = "real", statistic = c("IOA"))
  ioa_approx_5 = c(ioa_approx_5, temp4$IOA)
  
  
}


mean_fractional_bias_approx_5 = mean(fractional_bias_approx_5)
cat("Mean Fractional Bias for na.approx method with Gap Value of 5 is ",mean_fractional_bias_approx_5, "thats is, ",mean_fractional_bias_approx_5*100,"%\n\n")

mean_rmse_approx_5 = mean(rmse_approx_5)
cat("Mean RMSE for na.approx method with Gap Value of 5 is ",mean_rmse_approx_5, "thats is, ",mean_rmse_approx_5*100,"%\n\n")

mean_ioa_approx_5 = mean(ioa_approx_5)
cat("Mean IOA for na.approx method with Gap Value of 5 is ",mean_ioa_approx_5, "thats is, ",mean_ioa_approx_5*100,"%\n\n")

mean_mad_approx_5 = mean(mad_approx_5)
cat("Mean MAD for na.approx method with Gap Value of 5 is ",mean_mad_approx_5,"\n\n")

mad_approx = c(mad_approx,mean_mad_approx_5)
frac_bias_approx = c(frac_bias_approx,mean_fractional_bias_approx_5)
rmse_approx = c(rmse_approx,mean_rmse_approx_5)
ioa_approx = c(ioa_approx, mean_ioa_approx_5)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_approx_5)
rm(mean_mad_approx_5)
rm(fractional_bias_approx_5)
rm(mean_fractional_bias_approx_5)
rm(rmse_approx_5)
rm(mean_rmse_approx_5)
rm(ioa_approx_5)
rm(mean_ioa_approx_5)


```


Method = {zoo}na.approx
Gap = 10
```{r}
mad_approx_10 = c()
fractional_bias_approx_10 = c()
rmse_approx_10 = c()
ioa_approx_10 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:9) { #runs 5 times for every i loop iteration to introduce a gap of 10 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 10 starting from the seed point, so now we approximate and get the error for the iteration
  series_new$glucoseValue = na.approx(series_new$glucoseValue)
  
  #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_approx_10 = c(mad_approx_10,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_approx_10 = c(fractional_bias_approx_10, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_approx_10 = c(rmse_approx_10,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed",obs = "real", statistic = c("IOA"))
  ioa_approx_10 = c(ioa_approx_10, temp4$IOA)
  
  
}


mean_fractional_bias_approx_10 = mean(fractional_bias_approx_10)
cat("Mean Fractional Bias for na.approx method with Gap Value of 10 is ",mean_fractional_bias_approx_10, "thats is, ",mean_fractional_bias_approx_10*100,"%\n\n")

mean_rmse_approx_10 = mean(rmse_approx_10)
cat("Mean RMSE for na.approx method with Gap Value of 10 is ",mean_rmse_approx_10, "thats is, ",mean_rmse_approx_10*100,"%\n\n")

mean_ioa_approx_10 = mean(ioa_approx_10)
cat("Mean IOA for na.approx method with Gap Value of 10 is ",mean_ioa_approx_10, "thats is, ",mean_ioa_approx_10*100,"%\n\n")

mean_mad_approx_10 = mean(mad_approx_10)
cat("Mean MAD for na.approx method with Gap Value of 10 is ",mean_mad_approx_10,"\n\n")

mad_approx = c(mad_approx,mean_mad_approx_10)
frac_bias_approx = c(frac_bias_approx,mean_fractional_bias_approx_10)
rmse_approx = c(rmse_approx,mean_rmse_approx_10)
ioa_approx = c(ioa_approx, mean_ioa_approx_10)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_approx_10)
rm(mean_mad_approx_10)
rm(fractional_bias_approx_10)
rm(mean_fractional_bias_approx_10)
rm(rmse_approx_10)
rm(mean_rmse_approx_10)
rm(ioa_approx_10)
rm(mean_ioa_approx_10)


```


Method = {zoo}na.approx
Gap = 20
```{r}
mad_approx_20 = c()
fractional_bias_approx_20 = c()
rmse_approx_20 = c()
ioa_approx_20 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:19) { #runs 20 times for every i loop iteration to introduce a gap of 20 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 20 starting from the seed point, so now we approximate and get the error for the iteration
  series_new$glucoseValue = na.approx(series_new$glucoseValue)
  
  #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_approx_20 = c(mad_approx_20,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_approx_20 = c(fractional_bias_approx_20, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_approx_20 = c(rmse_approx_20,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed",obs = "real", statistic = c("IOA"))
  ioa_approx_20 = c(ioa_approx_20, temp4$IOA)
  
  
}


mean_fractional_bias_approx_20 = mean(fractional_bias_approx_20)
cat("Mean Fractional Bias for na.approx method with Gap Value of 20 is ",mean_fractional_bias_approx_20, "thats is, ",mean_fractional_bias_approx_20*100,"%\n\n")

mean_rmse_approx_20 = mean(rmse_approx_20)
cat("Mean RMSE for na.approx method with Gap Value of 20 is ",mean_rmse_approx_20, "thats is, ",mean_rmse_approx_20*100,"%\n\n")

mean_ioa_approx_20 = mean(ioa_approx_20)
cat("Mean IOA for na.approx method with Gap Value of 20 is ",mean_ioa_approx_20, "thats is, ",mean_ioa_approx_20*100,"%\n\n")

mean_mad_approx_20 = mean(mad_approx_20)
cat("Mean MAD for na.approx method with Gap Value of 20 is ",mean_mad_approx_20,"\n\n")

mad_approx = c(mad_approx,mean_mad_approx_20)
frac_bias_approx = c(frac_bias_approx,mean_fractional_bias_approx_20)
rmse_approx = c(rmse_approx,mean_rmse_approx_20)
ioa_approx = c(ioa_approx, mean_ioa_approx_20)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_approx_20)
rm(mean_mad_approx_20)
rm(fractional_bias_approx_20)
rm(mean_fractional_bias_approx_20)
rm(rmse_approx_20)
rm(mean_rmse_approx_20)
rm(ioa_approx_20)
rm(mean_ioa_approx_20)


```


Method = {zoo}na.approx
Gap = 25
```{r}
mad_approx_25 = c()
fractional_bias_approx_25 = c()
rmse_approx_25 = c()
ioa_approx_25 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:24) { #runs 25 times for every i loop iteration to introduce a gap of 25 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 5 starting from the seed point, so now we approximate and get the error for the iteration
  series_new$glucoseValue = na.approx(series_new$glucoseValue)
  
  #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_approx_25 = c(mad_approx_25,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_approx_25 = c(fractional_bias_approx_25, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_approx_25 = c(rmse_approx_25,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed",obs = "real", statistic = c("IOA"))
  ioa_approx_25 = c(ioa_approx_25, temp4$IOA)
  
  
}


mean_fractional_bias_approx_25 = mean(fractional_bias_approx_25)
cat("Mean Fractional Bias for na.approx method with Gap Value of 25 is ",mean_fractional_bias_approx_25, "thats is, ",mean_fractional_bias_approx_25*100,"%\n\n")

mean_rmse_approx_25 = mean(rmse_approx_25)
cat("Mean RMSE for na.approx method with Gap Value of 25 is ",mean_rmse_approx_25, "thats is, ",mean_rmse_approx_25*100,"%\n\n")

mean_ioa_approx_25 = mean(ioa_approx_25)
cat("Mean IOA for na.approx method with Gap Value of 25 is ",mean_ioa_approx_25, "thats is, ",mean_ioa_approx_25*100,"%\n\n")

mean_mad_approx_25 = mean(mad_approx_25)
cat("Mean MAD for na.approx method with Gap Value of 25 is ",mean_mad_approx_25,"\n\n")

mad_approx = c(mad_approx,mean_mad_approx_25)
frac_bias_approx = c(frac_bias_approx,mean_fractional_bias_approx_25)
rmse_approx = c(rmse_approx,mean_rmse_approx_25)
ioa_approx = c(ioa_approx, mean_ioa_approx_25)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_approx_25)
rm(mean_mad_approx_25)
rm(fractional_bias_approx_25)
rm(mean_fractional_bias_approx_25)
rm(rmse_approx_25)
rm(mean_rmse_approx_25)
rm(ioa_approx_25)
rm(mean_ioa_approx_25)


```


Method = {zoo}na.approx
Gap = 50
```{r}
mad_approx_50 = c()
fractional_bias_approx_50 = c()
rmse_approx_50 = c()
ioa_approx_50 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:49) { #runs 50 times for every i loop iteration to introduce a gap of 50 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 50 starting from the seed point, so now we approximate and get the error for the iteration
  series_new$glucoseValue = na.approx(series_new$glucoseValue)
  
  #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_approx_50 = c(mad_approx_50,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_approx_50 = c(fractional_bias_approx_50, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_approx_50 = c(rmse_approx_50,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed",obs = "real", statistic = c("IOA"))
  ioa_approx_50 = c(ioa_approx_50, temp4$IOA)
  
  
}


mean_fractional_bias_approx_50 = mean(fractional_bias_approx_50)
cat("Mean Fractional Bias for na.approx method with Gap Value of 50 is ",mean_fractional_bias_approx_50, "thats is, ",mean_fractional_bias_approx_50*100,"%\n\n")

mean_rmse_approx_50 = mean(rmse_approx_50)
cat("Mean RMSE for na.approx method with Gap Value of 50 is ",mean_rmse_approx_50, "thats is, ",mean_rmse_approx_50*100,"%\n\n")

mean_ioa_approx_50 = mean(ioa_approx_50)
cat("Mean IOA for na.approx method with Gap Value of 50 is ",mean_ioa_approx_50, "thats is, ",mean_ioa_approx_50*100,"%\n\n")

mean_mad_approx_50 = mean(mad_approx_50)
cat("Mean MAD for na.approx method with Gap Value of 50 is ",mean_mad_approx_50,"\n\n")

mad_approx = c(mad_approx,mean_mad_approx_50)
frac_bias_approx = c(frac_bias_approx,mean_fractional_bias_approx_50)
rmse_approx = c(rmse_approx,mean_rmse_approx_50)
ioa_approx = c(ioa_approx, mean_ioa_approx_50)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_approx_50)
rm(mean_mad_approx_50)
rm(fractional_bias_approx_50)
rm(mean_fractional_bias_approx_50)
rm(rmse_approx_50)
rm(mean_rmse_approx_50)
rm(ioa_approx_50)
rm(mean_ioa_approx_50)


```


Method = {zoo}na.approx
Gap = 100
```{r}
mad_approx_100 = c()
fractional_bias_approx_100 = c()
rmse_approx_100 = c()
ioa_approx_100 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:99) { #runs 100 times for every i loop iteration to introduce a gap of 100 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 10 starting from the seed point, so now we approximate and get the error for the iteration
  series_new$glucoseValue = na.approx(series_new$glucoseValue)
  
  #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_approx_100 = c(mad_approx_100,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_approx_100 = c(fractional_bias_approx_100, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_approx_100 = c(rmse_approx_100,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed",obs = "real", statistic = c("IOA"))
  ioa_approx_100 = c(ioa_approx_100, temp4$IOA)
  
  
}


mean_fractional_bias_approx_100 = mean(fractional_bias_approx_100)
cat("Mean Fractional Bias for na.approx method with Gap Value of 100 is ",mean_fractional_bias_approx_100, "thats is, ",mean_fractional_bias_approx_100*100,"%\n\n")

mean_rmse_approx_100 = mean(rmse_approx_100)
cat("Mean RMSE for na.approx method with Gap Value of 100 is ",mean_rmse_approx_100, "thats is, ",mean_rmse_approx_100*100,"%\n\n")

mean_ioa_approx_100 = mean(ioa_approx_100)
cat("Mean IOA for na.approx method with Gap Value of 100 is ",mean_ioa_approx_100, "thats is, ",mean_ioa_approx_100*100,"%\n\n")

mean_mad_approx_100 = mean(mad_approx_100)
cat("Mean MAD for na.approx method with Gap Value of 100 is ",mean_mad_approx_100,"\n\n")

mad_approx = c(mad_approx,mean_mad_approx_100)
frac_bias_approx = c(frac_bias_approx,mean_fractional_bias_approx_100)
rmse_approx = c(rmse_approx,mean_rmse_approx_100)
ioa_approx = c(ioa_approx, mean_ioa_approx_100)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_approx_100)
rm(mean_mad_approx_100)
rm(fractional_bias_approx_100)
rm(mean_fractional_bias_approx_100)
rm(rmse_approx_100)
rm(mean_rmse_approx_100)
rm(ioa_approx_100)
rm(mean_ioa_approx_100)


```



na.approx final values
```{r}
mad_approx
frac_bias_approx
rmse_approx
ioa_approx
```


na.spline error lists for plotting
```{r}
mad_spline = c()
frac_bias_spline = c()
rmse_spline = c()
ioa_spline = c()
```

Method = {zoo}na.spline
Gap = 5
```{r}
mad_spline_5 = c()
fractional_bias_spline_5 = c()
rmse_spline_5 = c()
ioa_spline_5 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:4) { #runs 5 times for every i loop iteration to introduce a gap of 5 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 5 starting from the seed point, so now we spline and get the error for the iteration
  series_new$glucoseValue = na.spline(series_new$glucoseValue)
  
  #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_spline_5 = c(mad_spline_5,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_spline_5 = c(fractional_bias_spline_5, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_spline_5 = c(rmse_spline_5,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed",obs = "real", statistic = c("IOA"))
  ioa_spline_5 = c(ioa_spline_5, temp4$IOA)
  
  
}


mean_fractional_bias_spline_5 = mean(fractional_bias_spline_5)
cat("Mean Fractional Bias for na.spline method with Gap Value of 5 is ",mean_fractional_bias_spline_5, "thats is, ",mean_fractional_bias_spline_5*100,"%\n\n")

mean_rmse_spline_5 = mean(rmse_spline_5)
cat("Mean RMSE for na.spline method with Gap Value of 5 is ",mean_rmse_spline_5, "thats is, ",mean_rmse_spline_5*100,"%\n\n")

mean_ioa_spline_5 = mean(ioa_spline_5)
cat("Mean IOA for na.spline method with Gap Value of 5 is ",mean_ioa_spline_5, "thats is, ",mean_ioa_spline_5*100,"%\n\n")

mean_mad_spline_5 = mean(mad_spline_5)
cat("Mean MAD for na.approx method with Gap Value of 5 is ",mean_mad_spline_5,"\n\n")

mad_spline = c(mad_spline,mean_mad_spline_5)
frac_bias_spline = c(frac_bias_spline,mean_fractional_bias_spline_5)
rmse_spline = c(rmse_spline,mean_rmse_spline_5)
ioa_spline = c(ioa_spline, mean_ioa_spline_5)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_spline_5)
rm(mean_mad_spline_5)
rm(fractional_bias_spline_5)
rm(mean_fractional_bias_spline_5)
rm(rmse_spline_5)
rm(mean_rmse_spline_5)
rm(ioa_spline_5)
rm(mean_ioa_spline_5)

```


Method = {zoo}na.spline
Gap = 10
```{r}
mad_spline_10 = c()
fractional_bias_spline_10 = c()
rmse_spline_10 = c()
ioa_spline_10 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:9) { #runs 10 times for every i loop iteration to introduce a gap of 10 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 10 starting from the seed point, so now we spline and get the error for the iteration
  series_new$glucoseValue = na.spline(series_new$glucoseValue)
  
  #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_spline_10 = c(mad_spline_10,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_spline_10 = c(fractional_bias_spline_10, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_spline_10 = c(rmse_spline_10,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed", obs = "real", statistic = c("IOA"))
  ioa_spline_10 = c(ioa_spline_10, temp4$IOA)
  
  
}


mean_fractional_bias_spline_10 = mean(fractional_bias_spline_10)
cat("Mean Fractional Bias for na.spline method with Gap Value of 10 is ",mean_fractional_bias_spline_10, "thats is, ",mean_fractional_bias_spline_10*100,"%\n\n")

mean_rmse_spline_10 = mean(rmse_spline_10)
cat("Mean RMSE for na.spline method with Gap Value of 10 is ",mean_rmse_spline_10, "thats is, ",mean_rmse_spline_10*100,"%\n\n")

mean_ioa_spline_10 = mean(ioa_spline_10)
cat("Mean IOA for na.spline method with Gap Value of 10 is ",mean_ioa_spline_10, "thats is, ",mean_ioa_spline_10*100,"%\n\n")

mean_mad_spline_10 = mean(mad_spline_10)
cat("Mean MAD for na.approx method with Gap Value of 10 is ",mean_mad_spline_10,"\n\n")

mad_spline = c(mad_spline,mean_mad_spline_10)
frac_bias_spline = c(frac_bias_spline,mean_fractional_bias_spline_10)
rmse_spline = c(rmse_spline,mean_rmse_spline_10)
ioa_spline = c(ioa_spline, mean_ioa_spline_10)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_spline_10)
rm(mean_mad_spline_10)
rm(fractional_bias_spline_10)
rm(mean_fractional_bias_spline_10)
rm(rmse_spline_10)
rm(mean_rmse_spline_10)
rm(ioa_spline_10)
rm(mean_ioa_spline_10)

```


Method = {zoo}na.spline
Gap = 20
```{r}
mad_spline_20 = c()
fractional_bias_spline_20 = c()
rmse_spline_20 = c()
ioa_spline_20 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:19) { #runs 20 times for every i loop iteration to introduce a gap of 20 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 20 starting from the seed point, so now we spline and get the error for the iteration
  series_new$glucoseValue = na.spline(series_new$glucoseValue)
  
  #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_spline_20 = c(mad_spline_20,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_spline_20 = c(fractional_bias_spline_20, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_spline_20 = c(rmse_spline_20,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed",obs = "real", statistic = c("IOA"))
  ioa_spline_20 = c(ioa_spline_20, temp4$IOA)
  
  
}


mean_fractional_bias_spline_20 = mean(fractional_bias_spline_20)
cat("Mean Fractional Bias for na.spline method with Gap Value of 20 is ",mean_fractional_bias_spline_20, "thats is, ",mean_fractional_bias_spline_20*100,"%\n\n")

mean_rmse_spline_20 = mean(rmse_spline_20)
cat("Mean RMSE for na.spline method with Gap Value of 20 is ",mean_rmse_spline_20, "thats is, ",mean_rmse_spline_20*100,"%\n\n")

mean_ioa_spline_20 = mean(ioa_spline_20)
cat("Mean IOA for na.spline method with Gap Value of 20 is ",mean_ioa_spline_20, "thats is, ",mean_ioa_spline_20*100,"%\n\n")

mean_mad_spline_20 = mean(mad_spline_20)
cat("Mean MAD for na.approx method with Gap Value of 20 is ",mean_mad_spline_20,"\n\n")

mad_spline = c(mad_spline,mean_mad_spline_20)
frac_bias_spline = c(frac_bias_spline,mean_fractional_bias_spline_20)
rmse_spline = c(rmse_spline,mean_rmse_spline_20)
ioa_spline = c(ioa_spline, mean_ioa_spline_20)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_spline_20)
rm(mean_mad_spline_20)
rm(fractional_bias_spline_20)
rm(mean_fractional_bias_spline_20)
rm(rmse_spline_20)
rm(mean_rmse_spline_20)
rm(ioa_spline_20)
rm(mean_ioa_spline_20)

```


Method = {zoo}na.spline
Gap = 25
```{r}
mad_spline_25 = c()
fractional_bias_spline_25 = c()
rmse_spline_25 = c()
ioa_spline_25 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:24) { #runs 25 times for every i loop iteration to introduce a gap of 25 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 20 starting from the seed point, so now we spline and get the error for the iteration
  series_new$glucoseValue = na.spline(series_new$glucoseValue)
  
  #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_spline_25 = c(mad_spline_25,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_spline_25 = c(fractional_bias_spline_25, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_spline_25 = c(rmse_spline_25,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed",obs = "real", statistic = c("IOA"))
  ioa_spline_25 = c(ioa_spline_25, temp4$IOA)
  
  
}


mean_fractional_bias_spline_25 = mean(fractional_bias_spline_25)
cat("Mean Fractional Bias for na.spline method with Gap Value of 25 is ",mean_fractional_bias_spline_25, "thats is, ",mean_fractional_bias_spline_25*100,"%\n\n")

mean_rmse_spline_25 = mean(rmse_spline_25)
cat("Mean RMSE for na.spline method with Gap Value of 25 is ",mean_rmse_spline_25, "thats is, ",mean_rmse_spline_25*100,"%\n\n")

mean_ioa_spline_25 = mean(ioa_spline_25)
cat("Mean IOA for na.spline method with Gap Value of 25 is ",mean_ioa_spline_25, "thats is, ",mean_ioa_spline_25*100,"%\n\n")

mean_mad_spline_25 = mean(mad_spline_25)
cat("Mean MAD for na.approx method with Gap Value of 25 is ",mean_mad_spline_25,"\n\n")

mad_spline = c(mad_spline,mean_mad_spline_25)
frac_bias_spline = c(frac_bias_spline,mean_fractional_bias_spline_25)
rmse_spline = c(rmse_spline,mean_rmse_spline_25)
ioa_spline = c(ioa_spline, mean_ioa_spline_25)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_spline_25)
rm(mean_mad_spline_25)
rm(fractional_bias_spline_25)
rm(mean_fractional_bias_spline_25)
rm(rmse_spline_25)
rm(mean_rmse_spline_25)
rm(ioa_spline_25)
rm(mean_ioa_spline_25)

```


Method = {zoo}na.spline
Gap = 50
```{r}
mad_spline_50 = c()
fractional_bias_spline_50 = c()
rmse_spline_50 = c()
ioa_spline_50 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:49) { #runs 50 times for every i loop iteration to introduce a gap of 50 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 50 starting from the seed point, so now we spline and get the error for the iteration
  series_new$glucoseValue = na.spline(series_new$glucoseValue)
  
  #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_spline_50 = c(mad_spline_50,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_spline_50 = c(fractional_bias_spline_50, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_spline_50 = c(rmse_spline_50,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed",obs = "real", statistic = c("IOA"))
  ioa_spline_50 = c(ioa_spline_50, temp4$IOA)
  
  
}


mean_fractional_bias_spline_50 = mean(fractional_bias_spline_50)
cat("Mean Fractional Bias for na.spline method with Gap Value of 50 is ",mean_fractional_bias_spline_50, "thats is, ",mean_fractional_bias_spline_50*100,"%\n\n")

mean_rmse_spline_50 = mean(rmse_spline_50)
cat("Mean RMSE for na.spline method with Gap Value of 50 is ",mean_rmse_spline_50, "thats is, ",mean_rmse_spline_50*100,"%\n\n")

mean_ioa_spline_50 = mean(ioa_spline_50)
cat("Mean IOA for na.spline method with Gap Value of 50 is ",mean_ioa_spline_50, "thats is, ",mean_ioa_spline_50*100,"%\n\n")

mean_mad_spline_50 = mean(mad_spline_50)
cat("Mean MAD for na.approx method with Gap Value of 50 is ",mean_mad_spline_50,"\n\n")

mad_spline = c(mad_spline,mean_mad_spline_50)
frac_bias_spline = c(frac_bias_spline,mean_fractional_bias_spline_50)
rmse_spline = c(rmse_spline,mean_rmse_spline_50)
ioa_spline = c(ioa_spline, mean_ioa_spline_50)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_spline_50)
rm(mean_mad_spline_50)
rm(fractional_bias_spline_50)
rm(mean_fractional_bias_spline_50)
rm(rmse_spline_50)
rm(mean_rmse_spline_50)
rm(ioa_spline_50)
rm(mean_ioa_spline_50)

```


Method = {zoo}na.spline
Gap = 100
```{r}
mad_spline_100 = c()
fractional_bias_spline_100 = c()
rmse_spline_100 = c()
ioa_spline_100 = c()
for (i in seed_points) { #runs once for each seed point, i.e., a total of 100 times where i is the seed point
  series_new = series
  #print("i loop")
  for (j in 0:99) { #runs 100 times for every i loop iteration to introduce a gap of 100 starting from a seed point
    series_new$glucoseValue[i+j] = NA
    #print("j loop")
  }
  #series_new now has a gap of 10 starting from the seed point, so now we spline and get the error for the iteration
  series_new$glucoseValue = na.spline(series_new$glucoseValue)
  
  #calculating mean absolute difference
  temp1 = mad(series_new$glucoseValue)
  mad_spline_100 = c(mad_spline_100,temp1)
  
  #calculating fractional bias
  temp2 = compute.fb(series_new$glucoseValue,series$glucoseValue)
  fractional_bias_spline_100 = c(fractional_bias_spline_100, temp2)
  
  #calculating RMSE
  temp3 = compute.rmse(series_new$glucoseValue,series$glucoseValue)
  rmse_spline_100 = c(rmse_spline_100,temp3)
  
  #calculatind IOA
  x = data.frame("real" = series$glucoseValue, 'imputed' = series_new$glucoseValue)
  temp4 = modStats(x,mod = "imputed", obs = "real", statistic = c("IOA"))
  ioa_spline_100 = c(ioa_spline_100, temp4$IOA)
  
  
}


mean_fractional_bias_spline_100 = mean(fractional_bias_spline_100)
cat("Mean Fractional Bias for na.spline method with Gap Value of 100 is ",mean_fractional_bias_spline_100, "thats is, ",mean_fractional_bias_spline_100*100,"%\n\n")

mean_rmse_spline_100 = mean(rmse_spline_100)
cat("Mean RMSE for na.spline method with Gap Value of 100 is ",mean_rmse_spline_100, "thats is, ",mean_rmse_spline_100*100,"%\n\n")

mean_ioa_spline_100 = mean(ioa_spline_100)
cat("Mean IOA for na.spline method with Gap Value of 100 is ",mean_ioa_spline_100, "thats is, ",mean_ioa_spline_100*100,"%\n\n")

mean_mad_spline_100 = mean(mad_spline_100)
cat("Mean MAD for na.approx method with Gap Value of 100 is ",mean_mad_spline_100,"\n\n")

mad_spline = c(mad_spline,mean_mad_spline_100)
frac_bias_spline = c(frac_bias_spline,mean_fractional_bias_spline_100)
rmse_spline = c(rmse_spline,mean_rmse_spline_100)
ioa_spline = c(ioa_spline, mean_ioa_spline_100)

rm(temp1)
rm(temp2)
rm(temp3)
rm(temp4)
rm(x)
rm(i)
rm(j)
rm(mad_spline_100)
rm(mean_mad_spline_100)
rm(fractional_bias_spline_100)
rm(mean_fractional_bias_spline_100)
rm(rmse_spline_100)
rm(mean_rmse_spline_100)
rm(ioa_spline_100)
rm(mean_ioa_spline_100)

```


na.spline error lists for plotting
```{r}
mad_spline
frac_bias_spline
rmse_spline
ioa_spline
```


Compating fractional biases for all three methods
```{r}
l=c('5','10','20','25','50','100')
plot(NULL,NULL, xaxt='n', xlim = c(1,6), ylim = c(0,0.009),xlab = 'Gap Size', ylab = 'Fractional Bias', main = 'Comparing Fractional Bias')
axis(1,at=seq(1:6),labels = l)
legend("topleft", c('na.approx', 'na.interp', 'na.spline'), col = c('red','blue','green'),lwd=2,cex=.75)
lines(frac_bias_approx, col = 'red',lwd=4)
lines(frac_bias_interp, col = 'blue',lwd=2)
lines(frac_bias_spline, col = 'green',lwd=2)
```


Compating mean absolute difference for all three methods
```{r}
plot(NULL,NULL, xaxt='n', xlim = c(1,6), ylim = c(2.72,2.82),xlab = 'Gap Size', ylab = 'Mean Absolute Difference', main = 'Comparing Mean Absolute Difference')
axis(1,at=seq(1:6),labels = l)
legend("topleft", c('na.approx', 'na.interp', 'na.spline'), col = c('red','blue','green'),lwd=2,cex=.75)
lines(mad_approx, col = 'red',lwd=4)
lines(mad_interp, col = 'blue',lwd=2)
lines(mad_spline, col = 'green',lwd=2)
```


Compating RMSE for all three methods
```{r}

plot(NULL,NULL, xaxt='n', xlim = c(1,6), ylim = c(0,0.4),xlab = 'Gap Size', ylab = 'RMSE', main = 'Comparing RMSE')
axis(1,at=seq(1:6),labels = l)
legend("topleft", c('na.approx', 'na.interp', 'na.spline'), col = c('red','blue','green'),lwd=2,cex=.75)
lines(rmse_approx, col = 'red',lwd=4)
lines(rmse_interp, col = 'blue',lwd=2)
lines(rmse_spline, col = 'green',lwd=2)
```


Compating index of agreement for all three methods
```{r}
plot(NULL,NULL, xaxt='n', xlim = c(1,6), ylim = c(0.982,1),xlab = 'Gap Size', ylab = 'Index of Agreement', main = 'Comparing Index of Agreement')
axis(1,at=seq(1:6),labels = l)
legend("topright", c('na.approx', 'na.interp', 'na.spline'), col = c('red','blue','green'),lwd=2,cex=.75)
lines(ioa_approx, col = 'red',lwd=4)
lines(ioa_interp, col = 'blue',lwd=2)
lines(ioa_spline, col = 'green',lwd=2)
```
